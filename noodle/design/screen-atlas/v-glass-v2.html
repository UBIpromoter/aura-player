<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aura â€” Screen Atlas (Glass v2)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --sat: 0px; --sar: 0px; --sab: 0px; --sal: 0px; }
    html, body, #root { margin: 0; padding: 0; height: 100%; width: 100%; }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; }

    @keyframes fadeSlideIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes scaleIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    @keyframes celebrateGlow { 0% { transform: scale(0.8); opacity: 0; } 50% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
    .celebrate-glow { animation: celebrateGlow 0.6s ease-out forwards; }

    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    /* ===== GLASS BACKGROUNDS ===== */
    .gallery-light {
      background: linear-gradient(135deg, #e8edf5 0%, #dce4f0 30%, #d5dff0 50%, #e2e9f4 70%, #eef2f9 100%);
      color: #1a1a1a;
      min-height: 100vh;
    }
    .gallery-dark {
      background: linear-gradient(135deg, #060a14 0%, #0c1225 35%, #0a1020 65%, #050810 100%);
      color: #fafafa;
      min-height: 100vh;
    }

    /* Background orbs for depth â€” subtle */
    .glass-orbs::before {
      content: '';
      position: fixed;
      top: -15%;
      left: -10%;
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(139, 92, 246, 0.06), transparent 70%);
      border-radius: 50%;
      pointer-events: none;
      z-index: 0;
    }
    .glass-orbs::after {
      content: '';
      position: fixed;
      bottom: -20%;
      right: -10%;
      width: 450px;
      height: 450px;
      background: radial-gradient(circle, rgba(59, 130, 246, 0.05), transparent 70%);
      border-radius: 50%;
      pointer-events: none;
      z-index: 0;
    }

    /* ===== GALLERY LAYOUT ===== */
    .gallery-row {
      display: flex;
      gap: 40px;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      padding: 0 max(40px, calc((100vw - 1400px) / 2)) 0;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .gallery-row::-webkit-scrollbar { display: none; }

    .gallery-item {
      scroll-snap-align: start;
      flex-shrink: 0;
      position: relative;
      transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .gallery-item:hover { transform: translateY(-8px); }

    .gallery-item .screen-label {
      position: absolute;
      bottom: -32px;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s ease;
      white-space: nowrap;
      font-size: 13px;
      font-weight: 400;
      letter-spacing: 0.02em;
    }
    .gallery-item:hover .screen-label { opacity: 1; }

    .phone-shadow-dark {
      filter: drop-shadow(0 20px 60px rgba(0,0,0,0.5)) drop-shadow(0 4px 12px rgba(0,0,0,0.3));
    }
    .phone-shadow-light {
      filter: drop-shadow(0 12px 40px rgba(0,0,0,0.08)) drop-shadow(0 4px 16px rgba(0,0,0,0.05));
    }

    .section-title { font-weight: 200; letter-spacing: -0.02em; line-height: 1.1; }

    .expanded-overlay {
      position: fixed;
      inset: 0;
      z-index: 200;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s ease;
    }
    .expanded-overlay.light-overlay {
      background: rgba(232, 237, 245, 0.95);
      backdrop-filter: blur(24px);
    }
    .expanded-overlay.dark-overlay {
      background: rgba(10, 14, 26, 0.92);
      backdrop-filter: blur(24px);
    }
    .expanded-phone { animation: scaleIn 0.35s cubic-bezier(0.16, 1, 0.3, 1); }

    .close-btn {
      position: absolute;
      top: 32px;
      right: 32px;
      z-index: 210;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      outline: none;
    }
    .close-btn-dark {
      background: rgba(255,255,255,0.08);
      color: rgba(255,255,255,0.6);
      backdrop-filter: blur(12px);
    }
    .close-btn-dark:hover { background: rgba(255,255,255,0.15); color: white; }
    .close-btn-light {
      background: rgba(255,255,255,0.6);
      color: rgba(0,0,0,0.4);
      backdrop-filter: blur(12px);
    }
    .close-btn-light:hover { background: rgba(255,255,255,0.85); color: rgba(0,0,0,0.7); }

    /* Glass-style filter pills */
    .nav-pill {
      padding: 6px 16px;
      border-radius: 100px;
      font-size: 13px;
      font-weight: 400;
      cursor: pointer;
      transition: all 0.25s ease;
      border: none;
      outline: none;
      letter-spacing: 0.01em;
    }

    .toggle-track {
      width: 44px;
      height: 24px;
      border-radius: 12px;
      cursor: pointer;
      position: relative;
      transition: background 0.3s ease;
      border: none;
      outline: none;
    }
    .toggle-thumb {
      position: absolute;
      top: 2px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: white;
      transition: left 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      box-shadow: 0 1px 3px rgba(0,0,0,0.15);
    }

    .screen-counter {
      font-size: 12px;
      font-weight: 300;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .expanded-meta {
      position: absolute;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      animation: fadeIn 0.4s ease 0.2s both;
    }

    .nav-arrows {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      outline: none;
      font-size: 18px;
      z-index: 210;
      backdrop-filter: blur(12px);
    }

    /* Phone bezel styling */
    .phone-bezel-light {
      background: linear-gradient(145deg, #e8e6e0, #d8d6d0);
      border: 1px solid rgba(0,0,0,0.08);
    }
    .phone-bezel-dark {
      background: linear-gradient(145deg, #1c1c1e, #2c2c2e);
      border: 1px solid rgba(255,255,255,0.06);
    }

    /* Shine card effects */
    .shine-card { position: relative; }
    .shine-card::before {
      content: '';
      position: absolute;
      inset: -1px;
      border-radius: inherit;
      background: linear-gradient(180deg, var(--accent-bright, rgba(255,255,255,0.5)) 0%, var(--accent-color, rgba(255,255,255,0.2)) 5%, transparent 15%, transparent 100%);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      padding: 2px;
      pointer-events: none;
      z-index: 20;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .shine-card:hover::before { opacity: 1; }
    .shine-blue { --accent-color: rgba(59, 130, 246, 0.3); --accent-bright: rgba(147, 197, 253, 0.6); }
    .shine-amber { --accent-color: rgba(251, 191, 36, 0.2); --accent-bright: rgba(253, 224, 71, 0.45); }
    .shine-violet { --accent-color: rgba(139, 92, 246, 0.25); --accent-bright: rgba(196, 181, 253, 0.55); }
    .shine-teal { --accent-color: rgba(45, 212, 191, 0.2); --accent-bright: rgba(153, 246, 228, 0.5); }
    .shine-emerald { --accent-color: rgba(16, 185, 129, 0.25); --accent-bright: rgba(110, 231, 183, 0.55); }
    .shine-rose { --accent-color: rgba(244, 63, 94, 0.25); --accent-bright: rgba(251, 113, 133, 0.55); }
    .shine-gray { --accent-color: rgba(156, 163, 175, 0.2); --accent-bright: rgba(209, 213, 219, 0.45); }
    .glow-amber { box-shadow: 0 0 15px rgba(251, 191, 36, 0.12), 0 0 35px rgba(251, 191, 36, 0.08); }
    .glow-violet { box-shadow: 0 0 18px rgba(139, 92, 246, 0.2), 0 0 40px rgba(139, 92, 246, 0.12); }
    .glow-teal { box-shadow: 0 0 18px rgba(45, 212, 191, 0.16), 0 0 40px rgba(45, 212, 191, 0.1); }
    .glow-blue { box-shadow: 0 0 20px rgba(59, 130, 246, 0.2), 0 0 45px rgba(59, 130, 246, 0.12); }
    .glow-emerald { box-shadow: 0 0 18px rgba(16, 185, 129, 0.16), 0 0 40px rgba(16, 185, 129, 0.1); }
    .glow-rose { box-shadow: 0 0 18px rgba(244, 63, 94, 0.16), 0 0 40px rgba(244, 63, 94, 0.1); }

    .starry-bg {
      background: linear-gradient(135deg, rgba(30, 20, 10, 0.9) 0%, rgba(50, 30, 15, 0.8) 100%);
      position: relative;
    }
    .starry-bg::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image: radial-gradient(1px 1px at 20px 30px, white, transparent),
        radial-gradient(1px 1px at 40px 70px, rgba(255,255,255,0.8), transparent),
        radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.7), transparent),
        radial-gradient(1px 1px at 130px 55px, white, transparent),
        radial-gradient(1.5px 1.5px at 200px 50px, rgba(255,255,255,0.9), transparent);
      opacity: 0.7;
      border-radius: inherit;
    }

    .question-text { font-size: clamp(14px, 4vw, 20px); line-height: 1.35; text-wrap: balance; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script>
const _warn = console.warn;
console.warn = (...args) => { if (typeof args[0] === 'string' && args[0].includes('cdn.tailwindcss.com')) return; _warn.apply(console, args); };
  </script>
  <script type="text/babel">
const { useState, useCallback, useEffect, useRef } = React;

// ==================== SHARED TOKENS ====================
const COLOR_HEX = {
  violet:  { base: '#8b5cf6', light: '#a78bfa', rgb: '139, 92, 246' },
  blue:    { base: '#3b82f6', light: '#60a5fa', rgb: '59, 130, 246' },
  teal:    { base: '#14b8a6', light: '#2dd4bf', rgb: '20, 184, 166' },
  rose:    { base: '#f43f5e', light: '#fb7185', rgb: '244, 63, 94' },
  pink:    { base: '#d946ef', light: '#e879f9', rgb: '217, 70, 239' },
  emerald: { base: '#10b981', light: '#34d399', rgb: '16, 185, 129' },
  slate:   { base: '#64748b', light: '#94a3b8', rgb: '100, 116, 139' },
  amber:   { base: '#f59e0b', light: '#fbbf24', rgb: '245, 158, 11' },
  indigo:  { base: '#6366f1', light: '#818cf8', rgb: '99, 102, 241' },
  cyan:    { base: '#06b6d4', light: '#67e8f9', rgb: '6, 182, 212' },
  gray:    { base: '#6b7280', light: '#9ca3af', rgb: '107, 114, 128' },
};

const PROGRESS_GRADIENTS = Object.fromEntries(
  Object.entries(COLOR_HEX).map(([c, hex]) => [c, { from: hex.base, to: hex.light }])
);

const TH = (token, dark) => ({
  'text-primary': dark ? 'text-white' : 'text-gray-900',
  'text-secondary': dark ? 'text-gray-300' : 'text-gray-700',
  'text-muted': dark ? 'text-gray-400' : 'text-gray-500',
  'text-subtle': dark ? 'text-gray-500' : 'text-gray-400',
  'text-faint': dark ? 'text-gray-600' : 'text-gray-400',
  'bg-main': dark ? 'bg-gray-950' : 'bg-gray-50',
  'bg-card': dark ? 'bg-gray-900 border border-gray-800' : 'bg-white border border-gray-200/80',
  'border-base': dark ? 'border-gray-800' : 'border-gray-200',
  'text-violet': dark ? 'text-violet-400' : 'text-violet-600',
  'text-emerald': dark ? 'text-emerald-400' : 'text-emerald-600',
  'text-rose': dark ? 'text-rose-400' : 'text-rose-600',
  'text-sky': dark ? 'text-sky-300' : 'text-sky-500',
  'text-dim': dark ? 'text-gray-400' : 'text-gray-500',
  'text-bright': dark ? 'text-gray-100' : 'text-gray-900',
}[token] || '');

// ==================== GLASS HELPER ====================
const glass = (darkMode, opacity = 0.08, blur = 16) => ({
  background: darkMode
    ? `rgba(255, 255, 255, ${opacity})`
    : `rgba(255, 255, 255, ${Math.min(opacity * 8, 0.72)})`,
  backdropFilter: `blur(${blur}px)${darkMode ? '' : ' saturate(1.5)'}`,
  WebkitBackdropFilter: `blur(${blur}px)${darkMode ? '' : ' saturate(1.5)'}`,
  border: `1px solid ${darkMode ? `rgba(255,255,255,${opacity + 0.02})` : 'rgba(255,255,255,0.6)'}`,
  boxShadow: darkMode ? 'none' : '0 2px 12px rgba(0,0,0,0.03), inset 0 1px 0 rgba(255,255,255,0.7)',
});

// ==================== SECTION CONFIG ====================
const SECTIONS = {
  Auth:        { color: '#6366f1', glow: 'rgba(99, 102, 241, 0.12)',  label: 'Auth',        icon: 'ðŸ”' },
  Onboarding:  { color: '#8b5cf6', glow: 'rgba(139, 92, 246, 0.12)',  label: 'Onboarding',  icon: 'ðŸš€' },
  Main:        { color: '#3b82f6', glow: 'rgba(59, 130, 246, 0.12)',  label: 'Main',        icon: 'ðŸ ' },
  Questions:   { color: '#14b8a6', glow: 'rgba(20, 184, 166, 0.12)', label: 'Questions',   icon: 'â“' },
  Settings:    { color: '#64748b', glow: 'rgba(100, 116, 139, 0.12)', label: 'Settings',    icon: 'âš™ï¸' },
  Assessments: { color: '#f59e0b', glow: 'rgba(245, 158, 11, 0.12)', label: 'Assessments', icon: 'ðŸ“Š' },
  Modals:      { color: '#ec4899', glow: 'rgba(236, 72, 153, 0.12)', label: 'Modals',      icon: 'ðŸ’¬' },
};

// ==================== PHONE FRAME with Dynamic Island ====================
const PhoneFrame = ({ children, darkMode, size = 'small', onClick, className = '' }) => {
  const isSmall = size === 'small';
  const w = isSmall ? 280 : 393;
  const h = isSmall ? 607 : 852;
  const bezel = isSmall ? 8 : 12;
  const outerRadius = isSmall ? 40 : 55;
  const innerRadius = isSmall ? 33 : 44;
  const diW = isSmall ? 80 : 126;
  const diH = isSmall ? 22 : 37;
  const diTop = isSmall ? 8 : 12;
  const statusH = isSmall ? 38 : 54;
  const homeW = isSmall ? 100 : 134;

  return (
    <div
      className={`relative ${className}`}
      style={{
        width: w + bezel * 2,
        height: h + bezel * 2,
        borderRadius: outerRadius,
        padding: bezel,
        flexShrink: 0,
        background: darkMode
          ? 'linear-gradient(145deg, #2a2a2e, #1a1a1c)'
          : 'linear-gradient(145deg, #d4d2cc, #c0beb8)',
        boxShadow: darkMode
          ? 'inset 0 1px 0 rgba(255,255,255,0.06), 0 0 0 1px rgba(0,0,0,0.3)'
          : 'inset 0 1px 0 rgba(255,255,255,0.8), 0 0 0 1px rgba(0,0,0,0.06)',
      }}
      onClick={onClick}
    >
      {/* Inner screen */}
      <div style={{
        width: w, height: h, borderRadius: innerRadius,
        overflow: 'hidden', position: 'relative', background: darkMode ? '#000' : '#fff',
      }}>
        {/* Dynamic Island */}
        <div style={{
          position: 'absolute', top: diTop, left: '50%', transform: 'translateX(-50%)',
          width: diW, height: diH,
          background: '#000', borderRadius: 9999, zIndex: 30,
        }} />
        {/* Status bar area - transparent so screen bg shows through */}
        <div style={{
          height: statusH, position: 'relative', zIndex: 20,
          display: 'flex', alignItems: 'flex-end', justifyContent: 'space-between',
          padding: `0 ${isSmall ? 20 : 32}px ${isSmall ? 4 : 8}px`,
          fontSize: isSmall ? 10 : 14, fontWeight: 600,
          color: darkMode ? '#fff' : '#000',
        }}>
          <span>9:41</span>
          <div style={{ display: 'flex', gap: isSmall ? 3 : 5, alignItems: 'center' }}>
            <svg width={isSmall ? 12 : 16} height={isSmall ? 9 : 12} viewBox="0 0 16 12" fill="currentColor" opacity="0.9">
              <rect x="0" y="8" width="3" height="4" rx="0.5"/>
              <rect x="4.5" y="5" width="3" height="7" rx="0.5"/>
              <rect x="9" y="2" width="3" height="10" rx="0.5"/>
              <rect x="13" y="0" width="3" height="12" rx="0.5"/>
            </svg>
            <svg width={isSmall ? 12 : 16} height={isSmall ? 9 : 12} viewBox="0 0 16 12" fill="currentColor" opacity="0.9">
              <path d="M8 2C5.5 2 3.2 3 1.5 4.7L0 3.2C2.1 1.2 4.9 0 8 0s5.9 1.2 8 3.2L14.5 4.7C12.8 3 10.5 2 8 2z"/>
              <path d="M8 6C6.3 6 4.8 6.7 3.7 7.8L2.2 6.3C3.7 4.8 5.7 4 8 4s4.3.8 5.8 2.3L12.3 7.8C11.2 6.7 9.7 6 8 6z"/>
              <circle cx="8" cy="11" r="1.5"/>
            </svg>
            <svg width={isSmall ? 18 : 24} height={isSmall ? 9 : 12} viewBox="0 0 25 12" fill="currentColor" opacity="0.9">
              <rect x="0" y="1" width="21" height="10" rx="2" fill="none" stroke="currentColor" strokeWidth="1"/>
              <rect x="22" y="4" width="2" height="4" rx="0.5" opacity="0.4"/>
              <rect x="1.5" y="2.5" width="14" height="7" rx="1" fill="currentColor"/>
            </svg>
          </div>
        </div>
        {/* Screen content */}
        <div style={{ position: 'absolute', top: 0, left: 0, right: 0, bottom: 0, display: 'flex', flexDirection: 'column', overflow: 'hidden' }}>
          <div style={{ height: statusH, flexShrink: 0 }} />
          <div style={{ flex: 1, display: 'flex', flexDirection: 'column', overflow: 'hidden' }}>
            {children}
          </div>
        </div>
        {/* Home indicator */}
        <div style={{
          position: 'absolute', bottom: isSmall ? 6 : 8, left: '50%', transform: 'translateX(-50%)',
          width: homeW, height: 5, borderRadius: 9999, zIndex: 20, opacity: 0.3,
          background: darkMode ? '#fff' : '#000',
        }} />
      </div>
    </div>
  );
};

// ==================== SCREEN: Welcome ====================
const ScreenWelcome = ({ darkMode }) => (
  <div className="flex-1 flex flex-col items-center justify-center px-6" style={{ backgroundColor: darkMode ? '#030712' : '#fafaf8' }}>
    <div className="text-5xl mb-5">&#127744;</div>
    <h1 className="text-2xl font-bold mb-2" style={{ color: darkMode ? '#fff' : '#1a1a1a' }}>Aura</h1>
    <p className="text-sm mb-10 text-center leading-relaxed" style={{ color: darkMode ? '#9ca3af' : '#6b7280' }}>
      Discover yourself, one<br/>question at a time
    </p>
    <div className="w-full max-w-[200px] space-y-3">
      <div className="w-full py-3 px-4 rounded-xl font-semibold text-base text-center bg-violet-500 text-white">
        Let's Go
      </div>
    </div>
    <div className="mt-6 text-xs" style={{ color: darkMode ? '#6b7280' : '#9ca3af' }}>Sign In</div>
  </div>
);

// ==================== SCREEN: Sign In ====================
const ScreenSignIn = ({ darkMode }) => (
  <div className="flex-1 flex flex-col items-center justify-center px-6" style={{ backgroundColor: darkMode ? '#030712' : '#fafaf8' }}>
    <div className="text-4xl mb-3">&#128273;</div>
    <h1 className="text-xl font-bold mb-5" style={{ color: darkMode ? '#fff' : '#1a1a1a' }}>Sign In</h1>
    <div className="w-full max-w-[220px] space-y-2.5">
      <div className={`w-full px-3 py-2.5 rounded-xl text-sm ${darkMode ? 'bg-gray-800 text-gray-500' : 'bg-gray-100 text-gray-400'}`}>
        Email
      </div>
      <div className={`w-full px-3 py-2.5 rounded-xl text-sm ${darkMode ? 'bg-gray-800 text-gray-500' : 'bg-gray-100 text-gray-400'}`}>
        PIN (4+ digits)
      </div>
      <div className="w-full py-2.5 px-4 rounded-xl font-medium text-sm text-center bg-violet-500 text-white">
        Sign In
      </div>
      <div className="text-center pt-1">
        <span className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>&larr; Back</span>
      </div>
      <div className={`text-[10px] text-center pt-1 ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>
        No account? <span className={darkMode ? 'text-violet-400' : 'text-violet-500'}>Create one</span>
      </div>
    </div>
  </div>
);

// ==================== SCREEN: Onboarding ====================
const ScreenOnboarding = ({ darkMode }) => {
  const violetShade = darkMode ? ['#5b21b6', '#7c3aed'] : ['#7c3aed', '#8b5cf6'];
  return (
    <div className={`flex-1 flex flex-col ${darkMode ? 'bg-gray-950' : 'bg-gray-50'}`}>
      <div className="flex items-center justify-between px-4 pt-2 pb-1">
        <span className="text-lg">&#127744;</span>
        <span className={`text-base ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>&#9776;</span>
      </div>
      <div className="flex-1 flex flex-col items-center justify-center px-5">
        <div className={`text-xs font-medium mb-4 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
          3 of 10
        </div>
        <h2 className={`text-base text-center font-medium mb-6 leading-snug ${TH('text-primary', darkMode)}`}>
          Is a hot dog a sandwich?
        </h2>
        <div className="w-full max-w-[200px] space-y-2">
          <div className="rounded-xl py-3 text-center font-bold text-white text-sm"
               style={{ background: `linear-gradient(135deg, ${violetShade[0]}, ${violetShade[1]})` }}>
            Yes, obviously
          </div>
          <div className={`rounded-xl py-3 text-center font-bold text-sm ${darkMode ? 'bg-gray-800 text-gray-300' : 'bg-white text-gray-600 border border-gray-200'}`}>
            No way
          </div>
        </div>
        <div className="flex gap-1 mt-6">
          {[...Array(10)].map((_, i) => (
            <div key={i} className={`w-1.5 h-1.5 rounded-full ${i < 3 ? 'bg-violet-500' : i === 3 ? 'bg-violet-400' : darkMode ? 'bg-gray-700' : 'bg-gray-300'}`} />
          ))}
        </div>
      </div>
    </div>
  );
};

// ==================== SCREEN: Path Choice ====================
const ScreenPathChoice = ({ darkMode }) => (
  <div className={`flex-1 flex flex-col ${darkMode ? 'bg-gray-950' : 'bg-gray-50'}`}>
    <div className="flex items-center justify-between px-4 pt-2 pb-1">
      <span className="text-lg">&#127744;</span>
      <span className={`text-base ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>&#9776;</span>
    </div>
    <div className="flex-1 flex flex-col items-center justify-center px-5">
      <div className="text-center mb-6">
        <div className="text-4xl mb-3">&#127881;</div>
        <h1 className={`text-xl font-bold mb-1 ${darkMode ? 'text-white' : 'text-gray-900'}`}>Nice! 10 down</h1>
        <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>You're on a roll. What next?</p>
      </div>
      <div className="w-full max-w-[240px] space-y-3">
        <div className={`w-full p-4 rounded-xl text-left border ${
          darkMode ? 'border-violet-500/30 bg-violet-900/20' : 'border-violet-200 bg-violet-50'
        }`}>
          <div className="flex items-center gap-3">
            <span className="text-2xl">&#129695;</span>
            <div className="flex-1 min-w-0">
              <div className={`text-sm font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`}>Learn About Yourself</div>
              <div className={`text-[10px] truncate ${darkMode ? 'text-violet-400/80' : 'text-violet-600'}`}>Take a quick personality quiz</div>
            </div>
            <span className={`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>&rarr;</span>
          </div>
        </div>
        <div className={`w-full p-4 rounded-xl text-left border ${
          darkMode ? 'border-teal-500/30 bg-teal-900/20' : 'border-teal-200 bg-teal-50'
        }`}>
          <div className="flex items-center gap-3">
            <span className="text-2xl">&#129517;</span>
            <div className="flex-1 min-w-0">
              <div className={`text-sm font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`}>Explore Topics</div>
              <div className={`text-[10px] truncate ${darkMode ? 'text-teal-400/80' : 'text-teal-600'}`}>Answer about things you care about</div>
            </div>
            <span className={`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>&rarr;</span>
          </div>
        </div>
      </div>
    </div>
  </div>
);

// ==================== SCREEN: Categories ====================
const ScreenCategories = ({ darkMode }) => (
  <div className={`flex-1 flex flex-col relative ${TH('bg-main', darkMode)}`}>
    <div className="flex items-center justify-between px-4 pt-2 pb-1">
      <div className="flex items-center gap-2">
        <span className="text-xl">&#127744;</span>
        <div className="flex items-center gap-1">
          <span className={`text-[10px] font-bold ${darkMode ? 'text-violet-400' : 'text-violet-600'}`}>Lv.3</span>
          <span className={`text-[9px] ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>145 XP</span>
        </div>
      </div>
      <div className="flex items-center gap-2">
        <span className="text-[10px] text-orange-400 font-medium">&#128293;5</span>
        <div className={`w-5 h-5 rounded-full flex items-center justify-center text-[10px] ${darkMode ? 'bg-gray-800 text-gray-400' : 'bg-gray-200 text-gray-500'}`}>P</div>
      </div>
    </div>
    <div className="flex-1 overflow-y-auto px-4 pt-1 pb-6 space-y-3 hide-scrollbar">
      <div className={`w-full rounded-xl p-3 text-center border ${
        darkMode ? 'bg-blue-900/30 border-blue-500/30' : 'bg-blue-50 border-blue-200'
      }`}>
        <div className={`font-medium text-[10px] mb-1 ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>&#127744; Question of the Day</div>
        <p className={`text-sm font-semibold leading-snug ${TH('text-primary', darkMode)}`}>
          Should AI identify itself?
        </p>
      </div>
      <h1 className={`text-xl font-bold text-center ${TH('text-primary', darkMode)}`}>What's on your mind?</h1>
      <div className="space-y-2.5">
        <div className={`w-full py-3 px-4 rounded-xl text-left border overflow-hidden ${
          darkMode ? 'starry-bg border-amber-500/30' : 'bg-amber-50 border-amber-200'
        }`}>
          <div className="flex items-center gap-3 relative z-10">
            <span className="text-xl">&#9728;&#65039;</span>
            <div className="min-w-0">
              <div className={`text-base font-semibold truncate ${TH('text-primary', darkMode)}`}>Predict</div>
              <div className={`text-[10px] truncate ${darkMode ? 'text-amber-400/80' : 'text-amber-600'}`}>What will happen?</div>
            </div>
          </div>
        </div>
        <div className={`w-full py-3 px-4 rounded-xl text-left border ${
          darkMode ? 'border-violet-500/30 bg-violet-900/20' : 'border-violet-200 bg-violet-50'
        }`}>
          <div className="flex items-center gap-3">
            <span className="text-lg">&#129504;</span>
            <div className="min-w-0">
              <div className={`text-sm font-semibold truncate ${TH('text-primary', darkMode)}`}>Think</div>
              <div className={`text-[10px] truncate ${darkMode ? 'text-violet-400/80' : 'text-violet-600'}`}>Logic puzzles &amp; analysis</div>
            </div>
          </div>
        </div>
        <div className={`w-full py-3 px-4 rounded-xl text-left border ${
          darkMode ? 'border-emerald-500/30 bg-emerald-900/20' : 'border-emerald-200 bg-emerald-50'
        }`}>
          <div className="flex items-center gap-3">
            <span className="text-lg">&#9878;&#65039;</span>
            <div className="min-w-0">
              <div className={`text-sm font-semibold truncate ${TH('text-primary', darkMode)}`}>Judge</div>
              <div className={`text-[10px] truncate ${darkMode ? 'text-emerald-400/80' : 'text-emerald-600'}`}>Ethics &amp; opinions</div>
            </div>
          </div>
        </div>
        <div className={`w-full py-3 px-4 rounded-xl text-left border ${
          darkMode ? 'border-rose-500/30 bg-rose-900/20' : 'border-rose-200 bg-rose-50'
        }`}>
          <div className="flex items-center gap-3">
            <span className="text-lg">&#10024;</span>
            <div className="min-w-0">
              <div className={`text-sm font-semibold truncate ${TH('text-primary', darkMode)}`}>Surprise me</div>
              <div className={`text-[10px] truncate ${darkMode ? 'text-rose-400/80' : 'text-rose-500'}`}>Something unexpected</div>
            </div>
          </div>
        </div>
        <div className={`w-full py-3 px-4 rounded-xl text-left border ${
          darkMode ? 'border-sky-500/30 bg-sky-900/20' : 'border-sky-200 bg-sky-50'
        }`}>
          <div className="flex items-center gap-3">
            <span className="text-lg">&#129695;</span>
            <div className="min-w-0">
              <div className={`text-sm font-semibold truncate ${TH('text-primary', darkMode)}`}>Reveal</div>
              <div className={`text-[10px] truncate ${darkMode ? 'text-sky-400/80' : 'text-sky-600'}`}>Discover yourself</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
);

// ==================== SCREEN: Profile ====================
const ScreenProfile = ({ darkMode }) => (
  <div className={`flex-1 flex flex-col ${TH('bg-main', darkMode)}`}>
    <div className={`flex items-center justify-between px-3 py-2 border-b ${TH('border-base', darkMode)}`}>
      <span className={`text-xs ${TH('text-violet', darkMode)}`}>&larr; Back</span>
      <h1 className={`text-sm font-semibold ${TH('text-primary', darkMode)}`}>Profile</h1>
      <span className={`text-xs ${TH('text-violet', darkMode)}`}>Edit</span>
    </div>
    <div className="flex-1 overflow-y-auto p-3 space-y-3 hide-scrollbar">
      <div className={`rounded-xl p-4 text-center ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
        <div className={`w-14 h-14 rounded-full mx-auto mb-2 flex items-center justify-center text-2xl ${darkMode ? 'bg-gray-800' : 'bg-gray-100'}`}>
          &#128100;
        </div>
        <h2 className={`text-base font-bold mb-0.5 ${TH('text-primary', darkMode)}`}>Philip</h2>
        <p className={`text-xs ${TH('text-muted', darkMode)}`}>Member since Jan 2025</p>
      </div>
      <div className={`rounded-xl p-3 ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
        <div className={`text-[9px] font-medium uppercase tracking-wide mb-2 ${TH('text-dim', darkMode)}`}>Stats</div>
        <div className="space-y-2">
          <div className="flex items-center justify-between">
            <span className={`text-xs ${TH('text-secondary', darkMode)}`}>Questions Answered</span>
            <span className={`text-sm font-bold ${TH('text-violet', darkMode)}`}>847</span>
          </div>
          <div className="flex items-center justify-between">
            <span className={`text-xs ${TH('text-secondary', darkMode)}`}>Current Streak</span>
            <span className="text-sm font-bold text-orange-400">5 &#128293;</span>
          </div>
          <div className="flex items-center justify-between">
            <span className={`text-xs ${TH('text-secondary', darkMode)}`}>Level</span>
            <span className={`text-sm font-bold ${TH('text-violet', darkMode)}`}>3</span>
          </div>
        </div>
      </div>
      <div className={`rounded-xl p-3 ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
        <div className={`text-[9px] font-medium uppercase tracking-wide mb-2 ${TH('text-dim', darkMode)}`}>Badges</div>
        <div className="flex gap-2 flex-wrap">
          {['&#127881;','&#128293;','&#11088;','&#127775;','&#128640;'].map((badge, i) => (
            <div key={i} className={`w-10 h-10 rounded-xl flex items-center justify-center text-lg ${darkMode ? 'bg-gray-800' : 'bg-gray-100'}`}>
              <span dangerouslySetInnerHTML={{__html: badge}} />
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
);

// ==================== SCREEN: Question of the Day ====================
const ScreenQotD = ({ darkMode }) => (
  <div className={`flex-1 flex flex-col ${TH('bg-main', darkMode)}`}>
    <div className={`flex items-center justify-between px-3 py-1.5 ${darkMode ? 'border-b border-white/5' : 'border-b border-gray-200/50'}`}>
      <span className="text-base">&#127744;</span>
      <span className={`text-[10px] ${TH('text-muted', darkMode)}`}>Question of the Day</span>
      <span className={`text-base ${TH('text-muted', darkMode)}`}>&#9776;</span>
    </div>
    <div className="flex-1 flex flex-col justify-center px-6 space-y-6">
      <div className="text-center space-y-3">
        <div className={`text-[11px] font-medium mb-3 ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>Question of the Day</div>
        <h2 className={`text-lg text-center font-semibold leading-snug px-2 ${TH('text-primary', darkMode)}`}>
          Should AI systems be required to identify themselves?
        </h2>
      </div>
      <div className="w-full max-w-[240px] mx-auto space-y-2.5">
        <div className="w-full py-3.5 rounded-xl font-bold text-center text-sm bg-emerald-500 text-white">
          YES
        </div>
        <div className="w-full py-3.5 rounded-xl font-bold text-center text-sm bg-rose-500 text-white">
          NO
        </div>
      </div>
    </div>
  </div>
);

// ==================== SCREEN: Binary Question ====================
const ScreenBinaryQuestion = ({ darkMode }) => (
  <div className={`flex-1 flex flex-col ${TH('bg-main', darkMode)}`}>
    <div className={`flex items-center justify-between px-3 py-1.5 ${darkMode ? 'border-b border-white/5' : 'border-b border-gray-200/50'}`}>
      <span className="text-base">&#127744;</span>
      <span className={`text-[10px] ${TH('text-muted', darkMode)}`}>42 answered</span>
      <span className={`text-base ${TH('text-muted', darkMode)}`}>&#9776;</span>
    </div>
    <div className="flex-1 flex flex-col justify-center px-4 space-y-3">
      <div className="space-y-1.5 p-3 rounded-xl">
        <div className="flex justify-center">
          <span className={`px-2 py-0.5 rounded-full text-[10px] font-medium ${darkMode ? 'bg-amber-900/30 text-amber-400' : 'bg-amber-100 text-amber-700'}`}>
            &#9728;&#65039; Predictions
          </span>
        </div>
        <h2 className={`text-base text-center font-medium leading-snug ${TH('text-primary', darkMode)}`}>
          Will humans live on Mars by 2050?
        </h2>
      </div>
      <div className="flex items-center gap-1.5 px-2">
        <div className="flex-1 h-[44px] rounded-xl font-bold overflow-hidden flex items-center justify-center"
             style={{ background: 'linear-gradient(135deg, #047857, #10b981)', color: 'white' }}>
          <span className="text-lg font-bold">YES</span>
          <span className="text-[10px] font-medium opacity-60 ml-1">&#9733;&#9733;</span>
        </div>
        <div className="w-8 h-[44px] flex-shrink-0 flex flex-col items-center justify-center gap-0.5">
          <div className={`w-4 h-4 rounded-full flex items-center justify-center text-[8px] ${darkMode ? 'bg-gray-700 text-gray-400' : 'bg-gray-200 text-gray-500'}`}>&#10005;</div>
          <div className="w-6 h-6 rounded-full text-white shadow-lg flex items-center justify-center text-xs bg-emerald-500">&#10003;</div>
        </div>
        <div className={`flex-1 h-[44px] rounded-xl font-bold overflow-hidden flex items-center justify-center ${darkMode ? 'bg-gray-800 text-gray-300' : 'bg-white text-rose-600 border border-rose-200'}`}>
          <span className="text-lg font-bold">NO</span>
        </div>
      </div>
    </div>
  </div>
);

// ==================== SCREEN: MC Question ====================
const ScreenMCQuestion = ({ darkMode }) => {
  const MC_COLORS = [
    { hex: '#3b82f6', shades: ['#93c5fd', '#60a5fa', '#3b82f6', '#2563eb'], rgb: '59, 130, 246' },
    { hex: '#8b5cf6', shades: ['#c4b5fd', '#a78bfa', '#8b5cf6', '#7c3aed'], rgb: '139, 92, 246' },
    { hex: '#14b8a6', shades: ['#5eead4', '#2dd4bf', '#14b8a6', '#0d9488'], rgb: '20, 184, 166' },
    { hex: '#06b6d4', shades: ['#67e8f9', '#22d3ee', '#06b6d4', '#0891b2'], rgb: '6, 182, 212' },
  ];
  const options = ['Utility vs duty', 'Action vs inaction', 'Individual vs group', 'Intuition vs logic'];
  const selectedIdx = 1;
  const tapCount = 2;

  return (
    <div className={`flex-1 flex flex-col ${TH('bg-main', darkMode)}`}>
      <div className={`flex items-center justify-between px-3 py-1.5 ${darkMode ? 'border-b border-white/5' : 'border-b border-gray-200/50'}`}>
        <span className="text-base">&#127744;</span>
        <span className={`text-[10px] ${TH('text-muted', darkMode)}`}>42 answered</span>
        <span className={`text-base ${TH('text-muted', darkMode)}`}>&#9776;</span>
      </div>
      <div className="flex-1 flex flex-col justify-center px-3 space-y-3">
        <div className="space-y-1.5 p-3 rounded-xl">
          <div className="flex justify-center">
            <span className={`px-2 py-0.5 rounded-full text-[10px] font-medium ${darkMode ? 'bg-violet-900/30 text-violet-400' : 'bg-violet-100 text-violet-700'}`}>
              &#129504; Reasoning
            </span>
          </div>
          <h2 className={`text-sm text-center font-medium leading-snug ${TH('text-primary', darkMode)}`}>
            The trolley problem is fundamentally about...
          </h2>
        </div>
        <div className="px-1 space-y-1">
          {options.map((opt, i) => {
            const color = MC_COLORS[i];
            const isSelected = i === selectedIdx;
            const style = isSelected
              ? { background: `linear-gradient(135deg, ${color.shades[1]}, ${color.shades[2]})`, color: 'white', border: `2px solid ${color.hex}` }
              : { background: darkMode ? 'rgb(31,41,55)' : 'rgb(255,255,255)', color: darkMode ? 'rgb(209,213,219)' : 'rgb(55,65,81)', border: darkMode ? '2px solid transparent' : '2px solid rgb(229,231,235)' };
            return (
              <div key={i} className="flex items-center gap-1">
                <div className="flex-1 h-[34px] px-2.5 rounded-lg text-left text-xs overflow-hidden relative flex items-center" style={style}>
                  <span className="font-medium mr-1 opacity-50 text-[10px]">{String.fromCharCode(65 + i)}.</span>
                  <span className="truncate">{opt}</span>
                  {isSelected && (
                    <span className="absolute top-1/2 right-1.5 -translate-y-1/2 text-[9px] font-bold bg-white/30 w-4 h-4 rounded-full flex items-center justify-center">
                      {tapCount}
                    </span>
                  )}
                </div>
                <div className="w-7 h-[34px] flex-shrink-0 flex flex-col items-center justify-center">
                  {isSelected && (
                    <>
                      <div className={`w-3 h-3 rounded-full flex items-center justify-center text-[7px] ${darkMode ? 'bg-gray-700 text-gray-400' : 'bg-gray-200 text-gray-500'}`}>&#10005;</div>
                      <div className="w-5 h-5 rounded-full text-white shadow flex items-center justify-center text-[10px]"
                           style={{ backgroundColor: color.hex }}>&#10003;</div>
                    </>
                  )}
                </div>
              </div>
            );
          })}
        </div>
      </div>
    </div>
  );
};

// ==================== SCREEN: Results ====================
const ScreenResults = ({ darkMode }) => {
  const yesColors = ['#10b981', '#34d399', '#6ee7b7', '#a7f3d0'];
  const noColors = ['#f43f5e', '#fb7185', '#fda4af', '#fecaca'];
  const yesByConf = [38, 28, 18, 8];
  const noByConf = [15, 12, 8, 5];
  const maxCount = 38;
  const highlightColor = darkMode ? 'white' : '#6b7280';

  const buildSegments = (byConf, colors, row) => {
    const segs = [];
    for (let i = 0; i < 4; i++) {
      const confLevel = 3 - i;
      const isUserConf = row.isUser && row.userConf === confLevel;
      if (byConf[i] > 0) segs.push({
        width: (byConf[i] / maxCount) * 100,
        color: colors[i],
        conf: confLevel,
        isUserConf
      });
    }
    return segs;
  };

  const rows = [
    { label: 'Yes', pct: '69%', byConf: yesByConf, colors: yesColors, isUser: true, userConf: 2 },
    { label: 'No', pct: '31%', byConf: noByConf, colors: noColors, isUser: false, userConf: null },
  ];

  return (
    <div className={`flex-1 flex flex-col ${TH('bg-main', darkMode)}`}>
      <div className={`flex items-center justify-between px-3 py-1.5 ${darkMode ? 'border-b border-white/5' : 'border-b border-gray-200/50'}`}>
        <span className="text-base">&#127744;</span>
        <span className={`text-[10px] ${TH('text-muted', darkMode)}`}>43 answered</span>
        <span className={`text-base ${TH('text-muted', darkMode)}`}>&#9776;</span>
      </div>
      <div className="flex-1 overflow-y-auto px-3 py-4 space-y-3">
        <div className={`w-full px-3 py-2 rounded-lg text-left ${darkMode ? 'bg-gray-900/80' : 'bg-white border border-gray-200/80'}`}>
          <div className={`text-xs font-medium mb-1.5 truncate ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
            Will humans live on Mars by 2050?
          </div>
          <div className="space-y-1">
            {rows.map((row, ri) => {
              const segments = buildSegments(row.byConf, row.colors, row);
              const totalWidth = segments.reduce((a, s) => a + s.width, 0);
              const emptyWidth = 100 - totalWidth;
              return (
                <div key={ri} className="flex items-center gap-1.5">
                  <span className={`text-[10px] w-6 font-semibold ${row.isUser ? 'border-2 rounded px-0.5' : ''}`}
                    style={{ color: row.colors[0], borderColor: row.isUser ? highlightColor : 'transparent' }}>{row.label}</span>
                  <span className="text-[10px] w-5" style={{ color: row.colors[0] }}>{row.pct}</span>
                  <div className={`flex-1 h-3 rounded-full overflow-hidden ${darkMode ? 'bg-black' : 'bg-gray-200'}`}>
                    <div className="h-full flex">
                      {segments.map((s, i) => (
                        <div key={i} className={`h-full relative flex items-center justify-center ${i === 0 ? 'rounded-l-full' : ''} ${i === segments.length - 1 && emptyWidth <= 0 ? 'rounded-r-full' : ''}`}
                          style={{
                            width: `${s.width}%`,
                            backgroundColor: s.color,
                            boxShadow: s.isUserConf ? 'inset 0 0 0 1px rgba(0,0,0,0.2)' : 'none'
                          }}>
                          {s.isUserConf && <span className="text-[8px] text-white font-bold">âœ“</span>}
                        </div>
                      ))}
                      {emptyWidth > 0 && (
                        <div className="h-full rounded-r-full" style={{ width: `${emptyWidth}%`, border: `1px solid ${row.colors[3]}`, borderLeft: 'none' }} />
                      )}
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
          <div className={`text-[10px] text-right mt-1 ${TH('text-faint', darkMode)}`}>1,847 responses &rarr;</div>
        </div>

        <div className={`rounded-lg p-3 ${darkMode ? 'bg-gray-900 shine-card glow-emerald' : 'bg-white border border-gray-200/80 shine-card'}`}>
          <div className="flex items-center gap-1.5 mb-1">
            <span className={`text-[10px] font-black uppercase tracking-wide ${darkMode ? 'text-sky-300' : 'text-sky-500'}`}>LAST:</span>
            <span className={`text-[9px] ${TH('text-subtle', darkMode)}`}>1,847 responses</span>
          </div>
          <p className={`text-xs font-medium mb-2 ${TH('text-bright', darkMode)}`}>Will humans live on Mars by 2050?</p>
          <div className="space-y-1">
            {rows.map((row, ri) => {
              const segments = buildSegments(row.byConf, row.colors, row);
              const totalWidth = segments.reduce((a, s) => a + s.width, 0);
              const emptyWidth = 100 - totalWidth;
              return (
                <div key={ri} className="flex items-center gap-1">
                  <span className={`text-xs w-7 font-semibold truncate ${row.isUser ? 'border-2 rounded px-0.5' : ''}`}
                    style={{ color: row.colors[1], borderColor: row.isUser ? highlightColor : 'transparent' }}>{row.label}</span>
                  <span className="text-xs w-6 font-bold text-right" style={{ color: row.colors[1] }}>{row.pct}</span>
                  <div className={`flex-1 h-3 rounded-full overflow-hidden ${darkMode ? 'bg-black/50' : 'bg-gray-200'}`}>
                    <div className="h-full flex">
                      {segments.map((s, i) => (
                        <div key={i} className={`h-full relative flex items-center justify-center ${i === 0 ? 'rounded-l-full' : ''} ${i === segments.length - 1 && emptyWidth <= 0 ? 'rounded-r-full' : ''}`}
                          style={{
                            width: `${s.width}%`,
                            backgroundColor: s.color,
                            boxShadow: s.isUserConf ? 'inset 0 0 0 1px rgba(0,0,0,0.2)' : 'none'
                          }}>
                          {s.isUserConf && <span className="text-[8px] text-white font-bold">âœ“</span>}
                        </div>
                      ))}
                      {emptyWidth > 0 && (
                        <div className="h-full rounded-r-full" style={{ width: `${emptyWidth}%`, border: `1px solid ${row.colors[3]}`, borderLeft: 'none' }} />
                      )}
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
          <div className={`text-[10px] text-center mt-2 ${TH('text-faint', darkMode)}`}>1,847 responses</div>
        </div>
        <div className={`text-center text-[10px] ${TH('text-faint', darkMode)}`}>Swipe for next &rarr;</div>
      </div>
    </div>
  );
};

// ==================== SCREEN: Settings ====================
const ScreenSettings = ({ darkMode }) => (
  <div className={`flex-1 flex flex-col overflow-hidden ${TH('bg-main', darkMode)}`}>
    <div className={`flex items-center justify-between px-3 py-2 border-b ${TH('border-base', darkMode)}`}>
      <span className={`text-xs ${TH('text-violet', darkMode)}`}>&larr; Back</span>
      <h1 className={`text-sm font-semibold ${TH('text-primary', darkMode)}`}>Settings</h1>
      <div className="w-10" />
    </div>
    <div className="flex-1 overflow-y-auto p-3 space-y-2 hide-scrollbar">
      <div className={`rounded-lg p-2.5 ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
        <div className="flex items-center justify-between">
          <div className={`text-xs font-medium ${TH('text-primary', darkMode)}`}>Theme</div>
          <div className={`relative w-10 h-5 rounded-full ${darkMode ? 'bg-violet-600' : 'bg-gray-200'}`}>
            <div className={`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow text-[8px] flex items-center justify-center ${darkMode ? 'translate-x-5' : 'translate-x-0.5'}`}>
              {darkMode ? '\u{1F319}' : '\u{2600}'}
            </div>
          </div>
        </div>
      </div>
      <div className={`rounded-lg p-2.5 ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
        <div className="flex items-center justify-between mb-1.5">
          <div className={`text-xs font-medium ${TH('text-primary', darkMode)}`}>Undo Delay</div>
          <span className={`text-xs font-bold ${TH('text-violet', darkMode)}`}>2s</span>
        </div>
        <div className={`w-full h-1 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-gray-200'}`}>
          <div className="h-full rounded-lg bg-violet-500" style={{ width: '66%' }} />
        </div>
      </div>
      {[
        { label: 'Require Submit', sub: 'Off = auto-submit', on: true },
        { label: 'Show Tips', sub: 'Gesture hints', on: true },
        { label: 'Streak Counter', sub: 'Show during play', on: true },
        { label: 'Demo Profiles', sub: 'Sample data', on: false },
      ].map((item, i) => (
        <div key={i} className={`rounded-lg p-2.5 ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
          <div className="flex items-center justify-between">
            <div className="min-w-0 flex-1 mr-2">
              <div className={`text-xs font-medium truncate ${TH('text-primary', darkMode)}`}>{item.label}</div>
              <div className={`text-[10px] truncate ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>{item.sub}</div>
            </div>
            <div className={`relative w-9 h-5 rounded-full flex-shrink-0 ${item.on ? 'bg-violet-600' : darkMode ? 'bg-gray-600' : 'bg-gray-200'}`}>
              <div className={`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow ${item.on ? 'translate-x-4' : 'translate-x-0.5'}`} />
            </div>
          </div>
        </div>
      ))}
      <div className={`rounded-lg p-2.5 ${darkMode ? 'bg-gray-900/50 border border-gray-800' : 'bg-white border border-gray-200/80'}`}>
        <div className={`text-[10px] font-medium mb-1.5 ${TH('text-dim', darkMode)}`}>Keyboard Shortcuts</div>
        <div className={`text-[10px] space-y-0.5 ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
          <div className="flex justify-between"><span>Yes / A</span><span className="font-mono">Y / 1</span></div>
          <div className="flex justify-between"><span>No / B-E</span><span className="font-mono">N / 2-5</span></div>
          <div className="flex justify-between"><span>Next</span><span className="font-mono">&rarr; / Space</span></div>
        </div>
      </div>
      <div className={`rounded-lg p-2.5 ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
        <div className={`text-xs font-medium mb-1.5 ${TH('text-primary', darkMode)}`}>Your Data</div>
        <div className="flex gap-1.5">
          <div className={`flex-1 py-1.5 rounded-lg text-[10px] font-medium text-center ${darkMode ? 'bg-emerald-900/30 text-emerald-400' : 'bg-emerald-50 text-emerald-600'}`}>Export</div>
          <div className={`flex-1 py-1.5 rounded-lg text-[10px] font-medium text-center ${darkMode ? 'bg-blue-900/30 text-blue-400' : 'bg-blue-50 text-blue-600'}`}>Import</div>
        </div>
      </div>
      <div className="flex gap-1.5">
        <div className={`flex-1 py-1.5 rounded-lg text-[10px] font-medium text-center ${darkMode ? 'bg-amber-900/30 text-amber-400' : 'bg-amber-50 text-amber-600'}`}>Clear</div>
        <div className={`flex-1 py-1.5 rounded-lg text-[10px] font-medium text-center ${darkMode ? 'bg-rose-900/30 text-rose-400' : 'bg-rose-50 text-rose-600'}`}>Reset</div>
      </div>
    </div>
  </div>
);

// ==================== SCREEN: Assessments ====================
const ScreenAssessments = ({ darkMode }) => {
  const Circle = ({ progress, size, sw, color, children, id }) => {
    const r = (size - sw) / 2;
    const circ = 2 * Math.PI * r;
    const grad = PROGRESS_GRADIENTS[color] || PROGRESS_GRADIENTS.violet;
    const gId = id || `ac-${size}-${color}-${progress}`;
    return (
      <div className="relative flex items-center justify-center" style={{ width: size, height: size }}>
        <svg width={size} height={size} className="absolute">
          <defs>
            <linearGradient id={gId} x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stopColor={progress > 0 ? grad.from : (darkMode ? '#374151' : '#d1d5db')} />
              <stop offset="100%" stopColor={progress > 0 ? grad.to : (darkMode ? '#4b5563' : '#e5e7eb')} />
            </linearGradient>
          </defs>
          <circle cx={size/2} cy={size/2} r={r} fill="none" stroke={darkMode ? '#1f2937' : '#e5e7eb'} strokeWidth={sw} />
          <circle cx={size/2} cy={size/2} r={r} fill="none" stroke={`url(#${gId})`} strokeWidth={sw} strokeLinecap="round"
            strokeDasharray={circ} strokeDashoffset={circ * (1 - progress / 100)}
            transform={`rotate(-90 ${size/2} ${size/2})`} />
        </svg>
        <span className="relative z-10 flex items-center justify-center" style={{ lineHeight: 1 }}>{children}</span>
      </div>
    );
  };

  return (
    <div className={`flex-1 flex flex-col ${TH('bg-main', darkMode)}`}>
      <div className={`h-[36px] flex-shrink-0 flex items-center gap-2 px-3 border-b ${TH('border-base', darkMode)}`}>
        <span className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>&larr;</span>
        <span className="text-lg select-none">&#129695;</span>
        <span className={`text-xs font-semibold flex-1 ${TH('text-primary', darkMode)}`}>Reveal</span>
        <span className="px-2 py-1 rounded-full text-[10px] font-medium bg-violet-600 text-white">Analysis</span>
      </div>
      <div className="flex-1 overflow-auto p-3 pb-16 hide-scrollbar">
        <div className="space-y-2 mb-4">
          <div className={`w-full p-3 rounded-xl ${TH('bg-card', darkMode)} flex items-center gap-3`}>
            <Circle progress={40} size={40} sw={3} color="blue" id="pick-qp">
              <span className="text-[10px] font-medium" style={{ color: PROGRESS_GRADIENTS.blue.to }}>10</span>
            </Circle>
            <div className="flex-1 min-w-0">
              <div className={`text-xs font-semibold truncate ${TH('text-primary', darkMode)}`}>Quick Profile</div>
              <div className={`text-[10px] ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>40% done</div>
            </div>
            <span className={`text-[10px] font-medium px-2 py-1 rounded-full flex-shrink-0 ${darkMode ? 'bg-blue-600/20 text-blue-400' : 'bg-blue-100 text-blue-600'}`}>Continue</span>
          </div>

          <div className={`rounded-xl overflow-hidden ${TH('bg-card', darkMode)}`}>
            <div className="w-full p-3 text-left flex items-center gap-2">
              <Circle progress={33} size={36} sw={3} color="indigo" id="pick-starter">
                <span className="text-[9px] font-medium" style={{ color: PROGRESS_GRADIENTS.indigo.to }}>2</span>
              </Circle>
              <div className="flex-1 min-w-0">
                <div className={`text-xs font-semibold truncate ${TH('text-primary', darkMode)}`}>Starter Pack</div>
                <div className={`text-[10px] ${darkMode ? 'text-indigo-400' : 'text-indigo-600'}`}>2 left</div>
              </div>
              <div className="flex gap-0.5 items-center">
                {[['&#127917;',100],['&#128293;',62],['&#128161;',0]].map(([icon, pct], j) => (
                  <Circle key={j} progress={pct} size={20} sw={2} color="indigo" id={`mod-ring-${j}`}>
                    <span className="text-[8px]" dangerouslySetInnerHTML={{__html: icon}} />
                  </Circle>
                ))}
              </div>
            </div>
            <div className={`divide-y ${darkMode ? 'divide-gray-800/50' : 'divide-gray-100'} border-t ${darkMode ? 'border-gray-800/50' : 'border-gray-100'}`}>
              <div className="px-3 py-2 flex items-center gap-2">
                <span className="text-[10px]">&#127917;</span>
                <span className={`text-[10px] truncate flex-1 ${TH('text-secondary', darkMode)}`}>Personality</span>
                <div className="w-16 h-1.5 rounded-full" style={{ background: `linear-gradient(to right, ${PROGRESS_GRADIENTS.indigo.from}, ${PROGRESS_GRADIENTS.indigo.to})` }} />
              </div>
              <div className="px-3 py-2 flex items-center gap-2">
                <span className="text-[10px]">&#128293;</span>
                <span className={`text-[10px] truncate flex-1 ${TH('text-secondary', darkMode)}`}>Motivation</span>
                <span className={`text-[9px] ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>5/8</span>
              </div>
              <div className="px-3 py-2 flex items-center gap-2">
                <span className="text-[10px]">&#128161;</span>
                <span className={`text-[10px] truncate flex-1 ${TH('text-secondary', darkMode)}`}>Thinking Style</span>
                <span className={`text-[9px] ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>0/8</span>
              </div>
            </div>
          </div>

          <div className={`w-full p-3 rounded-xl ${TH('bg-card', darkMode)} flex items-center gap-3 opacity-60`}>
            <Circle progress={0} size={40} sw={3} color="violet" id="pick-deep">
              <span className="text-[10px] font-medium" style={{ color: darkMode ? '#6b7280' : '#9ca3af' }}>40</span>
            </Circle>
            <div className="flex-1 min-w-0">
              <div className={`text-xs font-semibold truncate ${TH('text-primary', darkMode)}`}>Personality Deep</div>
              <div className={`text-[10px] ${darkMode ? 'text-violet-400' : 'text-violet-600'}`}>40 questions</div>
            </div>
            <span className={`text-[10px] font-medium px-2 py-1 rounded-full flex-shrink-0 ${darkMode ? 'bg-violet-600/20 text-violet-400' : 'bg-violet-100 text-violet-600'}`}>Start</span>
          </div>
        </div>

        <div className="mt-2">
          <div className={`text-[9px] font-medium uppercase tracking-wide mb-1.5 px-1 ${TH('text-dim', darkMode)}`}>
            Completed
          </div>
          <div className={`rounded-xl overflow-hidden ${TH('bg-card', darkMode)}`}>
            <div className="w-full px-3 py-2 flex items-center gap-2">
              <Circle progress={100} size={28} sw={2} color="emerald" id="pick-char">
                <span className="text-[10px]">&#128737;&#65039;</span>
              </Circle>
              <span className={`flex-1 text-left text-[10px] font-medium ${TH('text-primary', darkMode)}`}>Character</span>
              <span className={`text-[9px] ${darkMode ? 'text-emerald-400' : 'text-emerald-600'}`}>View &rarr;</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

// ==================== SCREEN: Assessment Taking ====================
const ScreenAssessmentTaking = ({ darkMode }) => {
  const scaleLabels = ['Strongly Disagree', 'Disagree', 'Neutral', 'Agree', 'Strongly Agree'];
  const selectedVal = 3;

  return (
    <div className={`flex-1 flex flex-col ${TH('bg-main', darkMode)}`}>
      <div className={`h-[36px] flex-shrink-0 flex items-center gap-2 px-3 border-b ${TH('border-base', darkMode)}`}>
        <span className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>&larr;</span>
        <span className="text-lg select-none">&#127917;</span>
        <span className={`text-xs font-semibold flex-1 ${TH('text-primary', darkMode)}`}>Quick Profile</span>
        <span className={`text-[10px] ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>6/25</span>
      </div>
      <div className="flex-1 flex flex-col justify-center px-4 space-y-4">
        <div className="text-center">
          <h2 className={`text-sm font-medium leading-snug mb-2 ${TH('text-primary', darkMode)}`}>
            I prefer working in a structured environment with clear rules.
          </h2>
        </div>
        <div className="space-y-2">
          {scaleLabels.map((label, i) => {
            const isSelected = i === selectedVal;
            return (
              <div key={i} className={`w-full py-2.5 px-3 rounded-lg text-xs text-center font-medium ${
                isSelected
                  ? 'bg-violet-500 text-white'
                  : darkMode
                    ? 'bg-gray-800 text-gray-300'
                    : 'bg-white text-gray-600 border border-gray-200'
              }`}>
                {label}
              </div>
            );
          })}
        </div>
      </div>
    </div>
  );
};

// ==================== SCREEN: Results Dashboard ====================
const ScreenResultsDashboard = ({ darkMode }) => {
  const traits = [
    { labelL: 'Introverted', labelR: 'Extraverted', pct: 78, colorL: '#8b5cf6', colorR: '#f59e0b' },
    { labelL: 'Agreeable', labelR: 'Challenging', pct: 38, colorL: '#8b5cf6', colorR: '#10b981' },
    { labelL: 'Conscientious', labelR: 'Spontaneous', pct: 71, colorL: '#f43f5e', colorR: '#14b8a6' },
    { labelL: 'Calm', labelR: 'Sensitive', pct: 42, colorL: '#10b981', colorR: '#f59e0b' },
    { labelL: 'Traditional', labelR: 'Open', pct: 65, colorL: '#6366f1', colorR: '#06b6d4' },
  ];

  return (
    <div className={`flex-1 flex flex-col ${TH('bg-main', darkMode)}`}>
      <div className={`h-[36px] flex-shrink-0 flex items-center gap-2 px-3 border-b ${TH('border-base', darkMode)}`}>
        <span className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>&larr;</span>
        <span className="text-lg select-none">&#127917;</span>
        <span className={`text-xs font-semibold flex-1 ${TH('text-primary', darkMode)}`}>Your Results</span>
        <span className={`text-xs ${TH('text-violet', darkMode)}`}>Share</span>
      </div>
      <div className="flex-1 overflow-y-auto p-3 space-y-3 hide-scrollbar">
        <div className={`rounded-xl p-4 text-center ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
          <div className="text-3xl mb-2">&#127917;</div>
          <h2 className={`text-base font-bold mb-1 ${TH('text-primary', darkMode)}`}>Personality Type</h2>
          <p className={`text-lg font-bold ${TH('text-violet', darkMode)} mb-2`}>INFJ-T</p>
          <p className={`text-xs ${TH('text-muted', darkMode)}`}>The Advocate</p>
        </div>
        <div className={`rounded-xl p-3 ${darkMode ? 'bg-gray-900' : 'bg-white border border-gray-200/80'}`}>
          <div className={`text-[9px] font-medium uppercase tracking-wide mb-2 ${TH('text-dim', darkMode)}`}>Traits</div>
          <div className="space-y-2.5">
            {traits.map((trait, i) => (
              <div key={i} className="space-y-0.5">
                <div className="flex items-center justify-between text-[10px]">
                  <span style={{ color: trait.colorL }}>{trait.labelL}</span>
                  <span style={{ color: trait.colorR }}>{trait.labelR}</span>
                </div>
                <div className={`w-full h-2 rounded-full relative ${darkMode ? 'bg-gray-800' : 'bg-gray-200'}`}>
                  <div className="h-full rounded-full" style={{
                    width: '100%',
                    background: `linear-gradient(to right, ${trait.colorL}, ${trait.colorR})`,
                  }} />
                  <div className="absolute top-1/2 -translate-y-1/2 w-3.5 h-3.5 rounded-full bg-white shadow-md"
                    style={{ left: `${trait.pct}%`, transform: 'translate(-50%, -50%)' }} />
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

// ==================== SCREEN: Modal Undo ====================
const ScreenModalUndo = ({ darkMode }) => (
  <div className={`flex-1 flex flex-col relative ${TH('bg-main', darkMode)}`}>
    <div className={`flex items-center justify-between px-3 py-1.5 ${darkMode ? 'border-b border-white/5' : 'border-b border-gray-200/50'}`}>
      <span className="text-base">&#127744;</span>
      <span className={`text-[10px] ${TH('text-muted', darkMode)}`}>43 answered</span>
      <span className={`text-base ${TH('text-muted', darkMode)}`}>&#9776;</span>
    </div>
    <div className="flex-1 flex flex-col justify-center px-4">
      <div className="space-y-1.5 p-3 rounded-xl">
        <div className="flex justify-center">
          <span className={`px-2 py-0.5 rounded-full text-[10px] font-medium ${darkMode ? 'bg-amber-900/30 text-amber-400' : 'bg-amber-100 text-amber-700'}`}>
            &#9728;&#65039; Predictions
          </span>
        </div>
        <h2 className={`text-base text-center font-medium leading-snug ${TH('text-primary', darkMode)}`}>
          Will humans live on Mars by 2050?
        </h2>
      </div>
    </div>
    <div className="absolute bottom-6 left-1/2 -translate-x-1/2 w-[90%] max-w-[260px]" style={{ animation: 'fadeSlideIn 0.3s ease' }}>
      <div className={`rounded-xl p-3 flex items-center justify-between ${darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200 shadow-lg'}`}>
        <span className={`text-xs ${TH('text-secondary', darkMode)}`}>Answer recorded</span>
        <button className={`px-3 py-1.5 rounded-lg text-xs font-medium ${darkMode ? 'bg-violet-600 text-white' : 'bg-violet-500 text-white'}`}>
          Undo
        </button>
      </div>
    </div>
  </div>
);

// ==================== SCREEN: Level Up ====================
const ScreenLevelUp = ({ darkMode }) => (
  <div className={`flex-1 flex items-center justify-center relative ${TH('bg-main', darkMode)}`}>
    <div className="absolute inset-0 flex items-center justify-center" style={{ animation: 'fadeIn 0.4s ease' }}>
      <div className="text-center px-6">
        <div className="relative inline-block mb-4">
          <div className="absolute inset-0 flex items-center justify-center">
            <div className="w-16 h-16 rounded-full celebrate-glow"
              style={{
                background: darkMode
                  ? 'radial-gradient(circle, rgba(139, 92, 246, 0.4), rgba(139, 92, 246, 0.1), transparent)'
                  : 'radial-gradient(circle, rgba(139, 92, 246, 0.3), rgba(139, 92, 246, 0.08), transparent)'
              }} />
          </div>
          <div className="relative text-6xl">&#127775;</div>
        </div>
        <h1 className={`text-2xl font-bold mb-2 ${TH('text-primary', darkMode)}`}>Level 4!</h1>
        <p className={`text-sm mb-6 ${TH('text-muted', darkMode)}`}>You've earned 250 XP</p>
        <div className={`inline-block px-4 py-2 rounded-xl text-sm font-semibold ${darkMode ? 'bg-violet-600 text-white' : 'bg-violet-500 text-white'}`}>
          Continue
        </div>
      </div>
    </div>
  </div>
);

// ==================== SCREENS ARRAY ====================
const SCREENS = [
  { id: 'welcome',            name: 'Welcome',             section: 'Auth',        component: ScreenWelcome },
  { id: 'sign-in',            name: 'Sign In',             section: 'Auth',        component: ScreenSignIn },
  { id: 'onboarding',         name: 'Onboarding',          section: 'Onboarding',  component: ScreenOnboarding },
  { id: 'path-choice',        name: 'Path Choice',         section: 'Onboarding',  component: ScreenPathChoice },
  { id: 'categories',         name: 'Categories',          section: 'Main',        component: ScreenCategories },
  { id: 'profile',            name: 'Profile',             section: 'Main',        component: ScreenProfile },
  { id: 'qotd',               name: 'Question of the Day', section: 'Questions',   component: ScreenQotD },
  { id: 'binary-question',    name: 'Binary Question',     section: 'Questions',   component: ScreenBinaryQuestion },
  { id: 'mc-question',        name: 'MC Question',         section: 'Questions',   component: ScreenMCQuestion },
  { id: 'results',            name: 'Results',             section: 'Questions',   component: ScreenResults },
  { id: 'settings',           name: 'Settings',            section: 'Settings',    component: ScreenSettings },
  { id: 'assessments',        name: 'Assessments',         section: 'Assessments', component: ScreenAssessments },
  { id: 'assessment-taking',  name: 'Assessment Taking',   section: 'Assessments', component: ScreenAssessmentTaking },
  { id: 'results-dashboard',  name: 'Results Dashboard',   section: 'Assessments', component: ScreenResultsDashboard },
  { id: 'modal-undo',         name: 'Modal: Undo',         section: 'Modals',      component: ScreenModalUndo },
  { id: 'level-up',           name: 'Level Up',            section: 'Modals',      component: ScreenLevelUp },
];

const SECTION_ORDER = ['Auth', 'Onboarding', 'Main', 'Questions', 'Settings', 'Assessments', 'Modals'];

// ==================== SCROLL ROW COMPONENT ====================
const SectionGrid = ({ title, screens, darkMode, onScreenClick }) => (
  <div className="mb-16" style={{ padding: '0 max(40px, calc((100vw - 1400px) / 2))', animation: 'fadeSlideIn 0.5s ease' }}>
    <div className="flex items-center gap-3 mb-8">
      <h2 className={`text-3xl font-extralight ${darkMode ? 'text-white' : 'text-gray-900'} section-title`}>
        {title}
      </h2>
      <span className={`text-xs font-medium ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>
        {screens.length} {screens.length === 1 ? 'screen' : 'screens'}
      </span>
    </div>
    <div className="flex flex-wrap gap-10">
      {screens.map((screen) => {
        const ScreenComp = screen.component;
        return (
          <div
            key={screen.id}
            className={`gallery-item ${darkMode ? 'phone-shadow-dark' : 'phone-shadow-light'}`}
            onClick={() => onScreenClick(screen)}
            style={{ cursor: 'pointer' }}
          >
            <PhoneFrame darkMode={darkMode} size="small">
              <ScreenComp darkMode={darkMode} />
            </PhoneFrame>
            <div className={`mt-3 text-center text-sm font-normal ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
              {screen.name}
            </div>
          </div>
        );
      })}
    </div>
  </div>
);

// ==================== MAIN APP ====================
const App = () => {
  const [darkMode, setDarkMode] = useState(true);
  const [expandedScreen, setExpandedScreen] = useState(null);
  const [filterSection, setFilterSection] = useState('All');

  useEffect(() => {
    document.body.className = darkMode ? 'dark-mode glass-orbs' : 'light-mode glass-orbs';
  }, [darkMode]);

  useEffect(() => {
    const handleKey = (e) => {
      if (!expandedScreen) return;
      const currentIdx = SCREENS.findIndex(s => s.id === expandedScreen.id);
      if (e.key === 'ArrowLeft' && currentIdx > 0) {
        setExpandedScreen(SCREENS[currentIdx - 1]);
      } else if (e.key === 'ArrowRight' && currentIdx < SCREENS.length - 1) {
        setExpandedScreen(SCREENS[currentIdx + 1]);
      } else if (e.key === 'Escape') {
        setExpandedScreen(null);
      }
    };
    window.addEventListener('keydown', handleKey);
    return () => window.removeEventListener('keydown', handleKey);
  }, [expandedScreen]);

  const filteredScreens = filterSection === 'All'
    ? SCREENS
    : SCREENS.filter(s => s.section === filterSection);

  const groupedScreens = SECTION_ORDER.reduce((acc, sec) => {
    const secScreens = filteredScreens.filter(s => s.section === sec);
    if (secScreens.length > 0) acc.push({ section: sec, screens: secScreens });
    return acc;
  }, []);

  const handlePrevScreen = () => {
    const currentIdx = SCREENS.findIndex(s => s.id === expandedScreen.id);
    if (currentIdx > 0) setExpandedScreen(SCREENS[currentIdx - 1]);
  };

  const handleNextScreen = () => {
    const currentIdx = SCREENS.findIndex(s => s.id === expandedScreen.id);
    if (currentIdx < SCREENS.length - 1) setExpandedScreen(SCREENS[currentIdx + 1]);
  };

  return (
    <div className={`min-h-screen ${darkMode ? 'gallery-dark' : 'gallery-light'}`}>
      {/* Header */}
      <div
        className="sticky top-0 z-50"
        style={{
          ...glass(darkMode, 0.06, 20),
          borderBottom: `1px solid ${darkMode ? 'rgba(255,255,255,0.08)' : 'rgba(255,255,255,0.6)'}`,
        }}
      >
        <div className="flex items-center justify-between px-8 py-5">
          <div className="flex items-center gap-4">
            <h1 className={`text-2xl font-light ${darkMode ? 'text-white' : 'text-gray-900'}`}>
              Aura Screen Atlas
            </h1>
            <span className={`screen-counter ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>
              {filteredScreens.length} screens
            </span>
          </div>
          <div className="flex items-center gap-3">
            <button
              onClick={() => setDarkMode(!darkMode)}
              className="toggle-track"
              style={{
                background: darkMode ? 'rgba(139, 92, 246, 0.3)' : 'rgba(100, 116, 139, 0.2)',
              }}
            >
              <div className="toggle-thumb" style={{ left: darkMode ? '22px' : '2px' }}>
                <span className="text-xs">{darkMode ? 'ðŸŒ™' : 'â˜€ï¸'}</span>
              </div>
            </button>
          </div>
        </div>
        {/* Section filters â€” minimal */}
        <div className="flex gap-2 px-8 pb-4 overflow-x-auto hide-scrollbar">
          {['All', ...SECTION_ORDER].map((sec) => {
            const isActive = filterSection === sec;
            return (
              <button
                key={sec}
                onClick={() => setFilterSection(sec)}
                className="nav-pill"
                style={{
                  background: isActive
                    ? (darkMode ? 'rgba(255,255,255,0.12)' : 'rgba(0,0,0,0.07)')
                    : 'transparent',
                  color: isActive
                    ? (darkMode ? '#fff' : '#1a1a1a')
                    : (darkMode ? 'rgba(255,255,255,0.4)' : 'rgba(0,0,0,0.4)'),
                  fontWeight: isActive ? 500 : 400,
                }}
              >
                {sec}
              </button>
            );
          })}
        </div>
      </div>

      {/* Gallery â€” vertical scroll grid */}
      <div className="py-12 relative z-10">
        {groupedScreens.map(({ section, screens }) => {
          const secInfo = SECTIONS[section];
          return (
            <SectionGrid
              key={section}
              title={secInfo.label}
              screens={screens}
              darkMode={darkMode}
              onScreenClick={setExpandedScreen}
            />
          );
        })}
      </div>

      {/* Expanded overlay */}
      {expandedScreen && (() => {
        const idx = SCREENS.findIndex(s => s.id === expandedScreen.id);
        const hasPrev = idx > 0;
        const hasNext = idx < SCREENS.length - 1;
        const secInfo = SECTIONS[expandedScreen.section];
        return (
          <div
            className={`expanded-overlay ${darkMode ? 'dark-overlay' : 'light-overlay'}`}
            onClick={(e) => {
              if (e.target === e.currentTarget) setExpandedScreen(null);
            }}
          >
            {/* Top bar with screen info */}
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, zIndex: 210,
              padding: '24px 32px', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
              <div>
                <div className={`text-lg font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                  {expandedScreen.name}
                </div>
                <div className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                  {secInfo.label} &middot; {idx + 1} / {SCREENS.length}
                </div>
              </div>
              <button
                onClick={() => setExpandedScreen(null)}
                className={`close-btn ${darkMode ? 'close-btn-dark' : 'close-btn-light'}`}
                style={{ position: 'static' }}
              >
                &#10005;
              </button>
            </div>

            {hasPrev && (
              <button
                onClick={handlePrevScreen}
                className="nav-arrows"
                style={{
                  left: '32px',
                  background: darkMode ? 'rgba(255,255,255,0.08)' : 'rgba(0,0,0,0.05)',
                  color: darkMode ? 'rgba(255,255,255,0.6)' : 'rgba(0,0,0,0.4)',
                }}
              >&#8249;</button>
            )}

            <div className="expanded-phone">
              <PhoneFrame darkMode={darkMode} size="large">
                {React.createElement(expandedScreen.component, { darkMode })}
              </PhoneFrame>
            </div>

            {hasNext && (
              <button
                onClick={handleNextScreen}
                className="nav-arrows"
                style={{
                  right: '32px',
                  background: darkMode ? 'rgba(255,255,255,0.08)' : 'rgba(0,0,0,0.05)',
                  color: darkMode ? 'rgba(255,255,255,0.6)' : 'rgba(0,0,0,0.4)',
                }}
              >&#8250;</button>
            )}
          </div>
        );
      })()}
    </div>
  );
};

// ==================== RENDER ====================
ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
