<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Aura Flow Demo ‚Äî Profile Redesign v2</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body, #root {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #111;
      overflow: hidden;
    }
    .phone-frame {
      width: 375px;
      height: 812px;
      background: #030712;
      border-radius: 40px;
      border: 8px solid #1a1a1a;
      box-shadow: 0 0 0 2px #333, 0 20px 60px rgba(0,0,0,0.5);
      overflow: hidden;
      position: relative;
    }
    .phone-frame::before {
      content: '';
      position: absolute;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 24px;
      background: #1a1a1a;
      border-radius: 12px;
      z-index: 10;
    }

    /* Neuron animations */
    @keyframes soft-glow {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }
    @keyframes gentle-drift {
      0% { transform: translate(0, 0); }
      25% { transform: translate(3px, -2px); }
      50% { transform: translate(-2px, 3px); }
      75% { transform: translate(2px, 2px); }
      100% { transform: translate(0, 0); }
    }
    @keyframes orb-pulse {
      0%, 100% { transform: scale(1); opacity: 0.8; }
      50% { transform: scale(1.03); opacity: 1; }
    }
    /* Neurons now animated via JS - lines follow dynamically */
    .synapse { opacity: 0.5; }
    .orb { animation: orb-pulse 4s ease-in-out infinite; }
    .glow { text-shadow: 0 0 20px rgba(139, 92, 246, 0.5); }

    @media (prefers-reduced-motion: reduce) {
      .neuron, .orb { animation: none; opacity: 0.8; }
    }

    /* Card styles */
    .card-glow {
      background: rgba(30, 20, 50, 0.4);
      border: 1px solid rgba(139, 92, 246, 0.2);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.05);
    }
    .hint-card {
      background: rgba(30, 25, 45, 0.6);
      border: 1px solid rgba(139, 92, 246, 0.15);
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // ==================== AURA VISUALIZATION ====================
    // Organic blurred ellipses creating colorful aura zones
    // Neurons animate independently, lines follow them dynamically
    const AuraVisualization = ({ stage }) => {
      const blue = '#60a5fa';
      const violet = '#8B5CF6';
      const emerald = '#10B981';
      const pink = '#EC4899';
      const cyan = '#06B6D4';

      // Aura ellipses for each stage
      const auraData = {
        1: [
          { cx: 100, cy: 70, rx: 80, ry: 60, color: violet, opacity: 0.85 },
          { cx: 100, cy: 130, rx: 70, ry: 50, color: blue, opacity: 0.7 },
        ],
        2: [
          { cx: 100, cy: 60, rx: 90, ry: 65, color: violet, opacity: 0.85 },
          { cx: 70, cy: 130, rx: 60, ry: 55, color: blue, opacity: 0.7 },
          { cx: 140, cy: 120, rx: 70, ry: 60, color: emerald, opacity: 0.8 },
        ],
        3: [
          { cx: 100, cy: 55, rx: 95, ry: 65, color: violet, opacity: 0.85 },
          { cx: 60, cy: 130, rx: 65, ry: 60, color: blue, opacity: 0.7 },
          { cx: 150, cy: 100, rx: 70, ry: 70, color: emerald, opacity: 0.8 },
          { cx: 100, cy: 150, rx: 80, ry: 55, color: pink, opacity: 0.8 },
        ],
        4: [
          { cx: 100, cy: 50, rx: 100, ry: 70, color: violet, opacity: 0.85 },
          { cx: 55, cy: 120, rx: 65, ry: 70, color: cyan, opacity: 0.8 },
          { cx: 150, cy: 90, rx: 70, ry: 75, color: emerald, opacity: 0.8 },
          { cx: 100, cy: 155, rx: 85, ry: 55, color: pink, opacity: 0.8 },
          { cx: 100, cy: 100, rx: 50, ry: 50, color: blue, opacity: 0.6 },
        ],
      }[stage];

      // Base neuron positions (before animation)
      const baseNeurons = {
        1: [
          { x: 100, y: 95, r: 6, color: violet },
          { x: 75, y: 72, r: 5, color: violet },
          { x: 128, y: 85, r: 4, color: blue },
          { x: 88, y: 118, r: 5, color: blue },
          { x: 115, y: 108, r: 4, color: violet },
        ],
        2: [
          { x: 103, y: 98, r: 6, color: violet },
          { x: 68, y: 65, r: 5, color: violet },
          { x: 135, y: 78, r: 5, color: emerald },
          { x: 82, y: 135, r: 5, color: blue },
          { x: 55, y: 102, r: 4, color: blue },
          { x: 118, y: 58, r: 4, color: emerald },
          { x: 142, y: 118, r: 4, color: emerald },
        ],
        3: [
          { x: 100, y: 100, r: 6, color: violet },
          { x: 62, y: 58, r: 5, color: violet },
          { x: 142, y: 72, r: 5, color: emerald },
          { x: 155, y: 108, r: 4, color: emerald },
          { x: 45, y: 95, r: 5, color: blue },
          { x: 78, y: 145, r: 5, color: pink },
          { x: 128, y: 138, r: 5, color: pink },
          { x: 95, y: 68, r: 4, color: violet },
          { x: 68, y: 115, r: 4, color: blue },
          { x: 138, y: 95, r: 3, color: emerald },
        ],
        4: [
          { x: 100, y: 98, r: 6, color: violet },
          { x: 58, y: 52, r: 5, color: violet },
          { x: 138, y: 48, r: 4, color: violet },
          { x: 155, y: 85, r: 5, color: emerald },
          { x: 148, y: 125, r: 4, color: pink },
          { x: 42, y: 88, r: 5, color: cyan },
          { x: 52, y: 135, r: 5, color: cyan },
          { x: 115, y: 148, r: 5, color: pink },
          { x: 72, y: 148, r: 4, color: pink },
          { x: 85, y: 65, r: 4, color: violet },
          { x: 125, y: 72, r: 4, color: emerald },
          { x: 65, y: 105, r: 3, color: cyan },
          { x: 135, y: 105, r: 3, color: emerald },
        ],
      }[stage];

      // Connection indices (which neurons connect to which)
      const connectionIndices = {
        1: [[0,1], [0,2], [0,3], [0,4], [1,3], [2,4], [1,2]],
        2: [[0,1], [0,2], [0,3], [0,4], [0,5], [0,6], [1,4], [1,5], [2,5], [2,6], [3,4], [3,6]],
        3: [[0,1], [0,2], [0,3], [0,4], [0,5], [0,6], [0,7], [0,8], [0,9], [1,7], [2,7], [2,9], [3,9], [3,6], [4,8], [4,5], [5,6], [1,4]],
        4: [[0,1], [0,2], [0,3], [0,4], [0,5], [0,6], [0,7], [0,8], [0,9], [0,10], [0,11], [0,12], [1,9], [2,10], [3,10], [3,12], [4,12], [4,7], [5,11], [5,6], [6,8], [8,7], [1,5], [2,3]],
      }[stage];

      // Animate neurons independently
      const [time, setTime] = useState(0);
      const animRef = useRef();

      useEffect(() => {
        const animate = () => {
          setTime(t => t + 0.02);
          animRef.current = requestAnimationFrame(animate);
        };
        animRef.current = requestAnimationFrame(animate);
        return () => cancelAnimationFrame(animRef.current);
      }, []);

      // Calculate animated positions - each neuron has unique drift pattern
      const animatedNeurons = baseNeurons.map((n, i) => {
        const speed = 0.5 + (i % 3) * 0.3;
        const amp = 1.5 + (i % 4) * 0.5;  // Reduced 50%
        const phaseX = i * 1.3;
        const phaseY = i * 0.9 + 0.5;
        return {
          ...n,
          x: n.x + Math.sin(time * speed + phaseX) * amp,
          y: n.y + Math.cos(time * speed * 0.8 + phaseY) * amp,
        };
      });

      const sizes = { 1: 180, 2: 200, 3: 220, 4: 240 };
      const size = sizes[stage];

      return (
        <div className="flex items-center justify-center" style={{ width: size, height: size * 1.1, margin: '0 auto' }}>
          <svg width={size} height={size * 1.1} viewBox="0 0 200 220" style={{ overflow: 'visible' }}>
            <defs>
              <filter id={`blur-${stage}`} x="-100%" y="-100%" width="300%" height="300%">
                <feGaussianBlur in="SourceGraphic" stdDeviation={stage === 4 ? 22 : 18} />
              </filter>
            </defs>

            {/* Organic aura glow */}
            <g filter={`url(#blur-${stage})`}>
              {auraData.map((e, i) => (
                <ellipse key={i} cx={e.cx} cy={e.cy} rx={e.rx} ry={e.ry} fill={e.color} opacity={e.opacity} />
              ))}
            </g>

            {/* Connection lines - dynamically follow neuron positions */}
            <g stroke="rgba(255,255,255,0.35)" strokeWidth="1">
              {connectionIndices.map(([from, to], i) => (
                <line
                  key={i}
                  x1={animatedNeurons[from].x}
                  y1={animatedNeurons[from].y}
                  x2={animatedNeurons[to].x}
                  y2={animatedNeurons[to].y}
                />
              ))}
            </g>

            {/* Neurons with glow */}
            {animatedNeurons.map((n, i) => (
              <g key={i}>
                <circle cx={n.x} cy={n.y} r={n.r * 2} fill={n.color} opacity="0.3" filter={`url(#blur-${stage})`} />
                <circle cx={n.x} cy={n.y} r={n.r} fill={n.color} />
              </g>
            ))}
          </svg>
        </div>
      );
    };

    // ==================== HINT CARD ====================
    const HintCard = ({ color, text, subtitle }) => {
      const borderColor = color.replace('bg-', 'border-').replace('-400', '-500/60');
      return (
        <div className={`rounded-xl p-3 border ${borderColor} bg-gray-900/40 flex items-start gap-3`}>
          <div className={`w-2.5 h-2.5 rounded-full ${color} mt-1 flex-shrink-0`}/>
          <div>
            <p className="text-sm font-medium text-gray-100">{text}</p>
            {subtitle && <p className="text-xs mt-0.5 text-gray-500">{subtitle}</p>}
          </div>
        </div>
      );
    };

    // ==================== TEASER VIEW ====================
    const TeaserView = ({ stage, hints, onContinue }) => {
      const statusText = {
        1: 'Your personality is forming...',
        2: 'Connections emerging...',
        3: 'Almost there...',
        4: 'Your Aura is ready'
      };

      return (
        <div className="flex-1 flex flex-col px-4 pt-12 pb-5" style={{background: 'linear-gradient(180deg, #0f0a1a 0%, #0a0a12 100%)'}}>
          {/* Header with stage */}
          <div className="flex items-center justify-between mb-3">
            <p className="text-gray-300 text-sm font-medium">Your Aura</p>
            <div className="flex items-center gap-1">
              {[1,2,3,4].map(s => (
                <div key={s} className={`w-1.5 h-1.5 rounded-full ${s <= stage ? 'bg-violet-400' : 'bg-gray-700'}`}/>
              ))}
            </div>
          </div>

          {/* Status text */}
          <p className={`text-center text-xs mb-4 ${stage === 4 ? 'text-violet-300 glow' : 'text-gray-500'}`}>
            {statusText[stage]}
          </p>

          {/* Hints from answers */}
          <div className="space-y-2 mb-4">
            {hints.map((h, i) => (
              <HintCard key={i} color={h.color} text={h.text} subtitle={h.desc}/>
            ))}
          </div>

          {/* Visualization with label */}
          <div className="flex-1 flex flex-col items-center justify-center min-h-0">
            <AuraVisualization stage={stage}/>
            <p className="text-gray-600 text-xs mt-2">
              {stage < 4 ? 'Your neural signature' : 'Your unique pattern'}
            </p>
          </div>

          {/* Progress and CTA */}
          <div className="mt-4">
            {stage < 4 && (
              <p className="text-gray-600 text-xs text-center mb-3">
                {stage === 1 ? '7 more to unlock next insight' : stage === 2 ? '5 more' : '2 more to complete'}
              </p>
            )}
            <button onClick={onContinue} className="w-full bg-violet-600 text-white text-sm font-medium py-3 rounded-xl active:bg-violet-700">
              {stage < 4 ? 'Continue ‚Üí' : 'View Your Profile ‚Üí'}
            </button>
          </div>
        </div>
      );
    };

    // ==================== PROFILE VIEW ====================
    const ProfileView = ({ onBack, expandedSection, setExpandedSection }) => (
      <div className="flex-1 flex flex-col overflow-hidden" style={{background: 'linear-gradient(180deg, #0f0a1a 0%, #0a0a12 100%)'}}>
        <div className="pt-10 h-14 flex items-center px-4 border-b border-gray-800/50">
          <button onClick={onBack} className="text-gray-500 text-lg">‚Üê</button>
          <span className="flex-1 text-center text-gray-200 font-medium">Your Profile</span>
          <div className="w-6"/>
        </div>

        <div className="flex-1 overflow-auto p-4 space-y-3">
          {/* Quick Profile */}
          <div className="card-glow rounded-xl overflow-hidden">
            <button onClick={() => setExpandedSection(expandedSection === 'quick' ? null : 'quick')} className="w-full p-4 flex items-center gap-3 text-left">
              <div className="w-10 h-10 rounded-xl bg-violet-500/20 border border-violet-500/30 flex items-center justify-center">
                <span className="text-violet-300">‚ú¶</span>
              </div>
              <div className="flex-1">
                <p className="text-gray-100 font-medium">Quick Profile</p>
                <p className="text-gray-500 text-xs">{expandedSection === 'quick' ? 'Your core pattern' : 'Composed Innovator'}</p>
              </div>
              <span className="text-violet-400">{expandedSection === 'quick' ? '‚àß' : '‚à®'}</span>
            </button>

            {expandedSection === 'quick' && (
              <div className="px-4 pb-4 space-y-3">
                <div className="bg-gray-800/30 rounded-lg p-3 text-center">
                  <p className="text-violet-300 text-lg font-semibold glow">Composed Innovator</p>
                  <p className="text-gray-500 text-xs mt-1">Explores new ideas with calm confidence</p>
                </div>

                <p className="text-gray-500 text-xs uppercase tracking-wide">Key Traits</p>
                <div className="flex flex-wrap gap-2">
                  <span className="px-2.5 py-1 rounded-full text-xs bg-violet-500/15 text-violet-300 border border-violet-500/20">Highly curious</span>
                  <span className="px-2.5 py-1 rounded-full text-xs bg-emerald-500/15 text-emerald-300 border border-emerald-500/20">Emotionally stable</span>
                  <span className="px-2.5 py-1 rounded-full text-xs bg-cyan-500/15 text-cyan-300 border border-cyan-500/20">Agreeable</span>
                  <span className="px-2.5 py-1 rounded-full text-xs bg-amber-500/15 text-amber-300 border border-amber-500/20">Moderately social</span>
                </div>

                <div className="bg-emerald-950/20 border border-emerald-500/15 rounded-lg p-3">
                  <p className="text-emerald-400 text-xs font-medium mb-1">‚úì Strengths</p>
                  <p className="text-gray-300 text-sm">You stay calm exploring new territory. Others trust your judgment because you think before reacting.</p>
                </div>

                <div className="bg-amber-950/20 border border-amber-500/15 rounded-lg p-3">
                  <p className="text-amber-400 text-xs font-medium mb-1">‚ñ≥ Watch out for</p>
                  <p className="text-gray-300 text-sm">May dismiss conventional approaches too quickly. Your calm can read as detached.</p>
                </div>

                <div className="bg-cyan-950/20 border border-cyan-500/15 rounded-lg p-3">
                  <p className="text-cyan-400 text-xs font-medium mb-1">‚óá Try this</p>
                  <p className="text-gray-300 text-sm">Balance novel approaches with proven methods. Signal engagement to those who need visible reassurance.</p>
                </div>
              </div>
            )}
          </div>

          {/* Personality */}
          <button onClick={() => setExpandedSection(expandedSection === 'personality' ? null : 'personality')} className="w-full card-glow rounded-xl p-4 flex items-center gap-3 text-left">
            <div className="w-10 h-10 rounded-xl bg-indigo-500/20 border border-indigo-500/30 flex items-center justify-center">
              <span className="text-indigo-300">‚óé</span>
            </div>
            <div className="flex-1">
              <p className="text-gray-100 font-medium">Personality</p>
              <p className="text-emerald-400 text-xs">Complete</p>
            </div>
            <span className="text-violet-400">‚à®</span>
          </button>

          {/* Insights */}
          <div className="card-glow rounded-xl overflow-hidden">
            <button onClick={() => setExpandedSection(expandedSection === 'insights' ? null : 'insights')} className="w-full p-4 flex items-center gap-3 text-left">
              <div className="w-10 h-10 rounded-xl bg-violet-500/20 border border-violet-500/30 flex items-center justify-center">
                <span className="text-violet-300">‚ú¶</span>
              </div>
              <div className="flex-1">
                <p className="text-gray-100 font-medium">How Your Traits Combine</p>
                <p className="text-gray-500 text-xs">3 patterns discovered</p>
              </div>
              <span className="text-violet-400">{expandedSection === 'insights' ? '‚àß' : '‚à®'}</span>
            </button>

            {expandedSection === 'insights' && (
              <div className="px-4 pb-4 space-y-3">
                <button className="w-full bg-gray-800/30 border border-gray-700/30 rounded-xl p-3 flex items-center gap-3 text-left">
                  <div className="w-10 h-10 rounded-lg bg-violet-900/30 border border-violet-500/20 flex items-center justify-center">
                    <span>üß≠</span>
                  </div>
                  <div className="flex-1">
                    <p className="text-gray-100 text-sm font-medium">Curious Explorer</p>
                    <p className="text-gray-500 text-xs">High curiosity + emotional stability lets you explore freely.</p>
                  </div>
                </button>

                <button className="w-full bg-gray-800/30 border border-gray-700/30 rounded-xl p-3 flex items-center gap-3 text-left">
                  <div className="w-10 h-10 rounded-lg bg-indigo-900/30 border border-indigo-500/20 flex items-center justify-center">
                    <span>üìö</span>
                  </div>
                  <div className="flex-1">
                    <p className="text-gray-100 text-sm font-medium">Rich Inner World</p>
                    <p className="text-gray-500 text-xs">Introversion + openness creates deep thought.</p>
                  </div>
                </button>

                <button className="w-full bg-gray-800/30 border border-gray-700/30 rounded-xl p-3 flex items-center gap-3 text-left">
                  <div className="w-10 h-10 rounded-lg bg-cyan-900/30 border border-cyan-500/20 flex items-center justify-center">
                    <span>‚öñÔ∏è</span>
                  </div>
                  <div className="flex-1">
                    <p className="text-gray-100 text-sm font-medium">Thoughtful Negotiator</p>
                    <p className="text-gray-500 text-xs">Agreeableness + conscientiousness means you follow through.</p>
                  </div>
                </button>
              </div>
            )}
          </div>

          {/* Relationships */}
          <button className="w-full card-glow rounded-xl p-4 flex items-center gap-3 text-left">
            <div className="w-10 h-10 rounded-xl bg-pink-500/20 border border-pink-500/30 flex items-center justify-center">
              <span className="text-pink-300">‚ô°</span>
            </div>
            <div className="flex-1">
              <p className="text-gray-100 font-medium">Relationships</p>
              <p className="text-emerald-400 text-xs">Complete</p>
            </div>
            <span className="text-violet-400">‚à®</span>
          </button>
        </div>
      </div>
    );

    // ==================== MAIN APP ====================
    function App() {
      const [screen, setScreen] = useState('teaser-1'); // teaser-1, teaser-2, teaser-3, teaser-4, profile
      const [expandedSection, setExpandedSection] = useState(null);

      const hints = {
        'teaser-1': [
          { color: 'bg-violet-400', text: 'Strong curiosity', desc: 'You seek out new ideas and experiences' },
        ],
        'teaser-2': [
          { color: 'bg-violet-400', text: 'Strong curiosity', desc: 'You seek out new ideas and experiences' },
          { color: 'bg-emerald-400', text: 'Natural warmth', desc: 'Others feel at ease around you' },
        ],
        'teaser-3': [
          { color: 'bg-violet-400', text: 'Strong curiosity', desc: 'You seek out new ideas and experiences' },
          { color: 'bg-emerald-400', text: 'Natural warmth', desc: 'Others feel at ease around you' },
          { color: 'bg-pink-400', text: 'Steady under pressure', desc: 'You stay calm when things get intense' },
        ],
        'teaser-4': [
          { color: 'bg-violet-400', text: 'Strong curiosity', desc: 'You seek out new ideas and experiences' },
          { color: 'bg-emerald-400', text: 'Natural warmth', desc: 'Others feel at ease around you' },
          { color: 'bg-pink-400', text: 'Steady under pressure', desc: 'You stay calm when things get intense' },
          { color: 'bg-cyan-400', text: 'Independent thinker', desc: 'You trust your own judgment' },
        ],
      };

      const handleContinue = () => {
        if (screen === 'teaser-1') setScreen('teaser-2');
        else if (screen === 'teaser-2') setScreen('teaser-3');
        else if (screen === 'teaser-3') setScreen('teaser-4');
        else if (screen === 'teaser-4') setScreen('profile');
      };

      const getStage = () => {
        if (screen === 'teaser-1') return 1;
        if (screen === 'teaser-2') return 2;
        if (screen === 'teaser-3') return 3;
        return 4;
      };

      return (
        <div className="h-full flex items-center justify-center p-4">
          <div className="flex flex-col items-center gap-4">
            {/* Navigation - outside phone */}
            <div className="flex justify-center gap-2">
              {['teaser-1', 'teaser-2', 'teaser-3', 'teaser-4', 'profile'].map((s, i) => (
                <button
                  key={s}
                  onClick={() => { setScreen(s); setExpandedSection(null); }}
                  className={`px-3 py-1.5 rounded-full text-xs font-medium transition-colors ${screen === s ? 'bg-violet-600 text-white' : 'bg-gray-800 text-gray-400 hover:bg-gray-700'}`}
                >
                  {i < 4 ? `Stage ${i+1}` : 'Profile'}
                </button>
              ))}
            </div>

            {/* Phone frame */}
            <div className="phone-frame flex flex-col">
              {screen.startsWith('teaser') ? (
                <TeaserView stage={getStage()} hints={hints[screen]} onContinue={handleContinue}/>
              ) : (
                <ProfileView onBack={() => setScreen('teaser-4')} expandedSection={expandedSection} setExpandedSection={setExpandedSection}/>
              )}
            </div>

            {/* Instructions - outside phone */}
            <p className="text-gray-600 text-xs">Click navigation or Continue to progress</p>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
